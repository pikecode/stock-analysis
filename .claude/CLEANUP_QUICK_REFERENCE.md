# æ•°æ®æ¸…ç†å¿«é€Ÿå‚è€ƒ

## å¿«é€Ÿæ¸…ç†è‚¡ç¥¨æ•°æ®

### æœ€ç®€å•çš„æ–¹å¼ï¼ˆæ¨èï¼‰

```bash
cd backend
./scripts/clean_stock_data.sh
```

å°±è¿™ä¹ˆç®€å•ï¼è„šæœ¬ä¼šï¼š
1. âœ… æ˜¾ç¤ºç¡®è®¤æç¤ºï¼ˆé˜²æ­¢è¯¯æ“ä½œï¼‰
2. âœ… æ¸…ç©º 10 ä¸ªè‚¡ç¥¨ç›¸å…³è¡¨ï¼ˆ~580,000 æ¡è®°å½•ï¼‰
3. âœ… è‡ªåŠ¨éªŒè¯ç»“æœ

### ç›´æ¥ä½¿ç”¨ SQLï¼ˆè·³è¿‡ç¡®è®¤ï¼‰

```bash
psql -U peak -d stock_analysis -f backend/scripts/clean_stock_data.sql
```

### è‡ªå®šä¹‰ç”¨æˆ·å

```bash
DB_USER=your_username ./backend/scripts/clean_stock_data.sh
```

---

## æ¸…ç†çš„è¡¨ï¼ˆå…± 10 ä¸ªï¼‰

| è¡¨å | ä½œç”¨ | åˆ é™¤è®°å½•æ•° |
|------|------|----------|
| stocks | è‚¡ç¥¨ä¸»æ•°æ® | 6,407 |
| concepts | æ¦‚å¿µåˆ†ç±» | 563 |
| industries | è¡Œä¸šåˆ†ç±» | 110 |
| stock_concepts | è‚¡ç¥¨-æ¦‚å¿µå…³ç³» | 53,439 |
| stock_industries | è‚¡ç¥¨è¡Œä¸šå…³ç³» | 5,426 |
| stock_metric_data_raw | æŒ‡æ ‡æ•°æ®ï¼ˆåˆ†åŒºï¼‰ | 16,728 |
| concept_stock_daily_rank | æ’åæ•°æ®ï¼ˆåˆ†åŒºï¼‰ | 109,624 |
| concept_daily_summary | æ±‡æ€»æ•°æ® | 1,124 |
| import_batches | å¯¼å…¥æ‰¹æ¬¡ | 14 |
| stock_concept_mapping_raw | CSV å¯¼å…¥åŸå§‹æ•°æ® | 386,604 |
| **æ€»è®¡** | | **~579,000** |

---

## å…¸å‹å·¥ä½œæµ

### å¯¼å…¥æµ‹è¯•å¾ªç¯

```bash
# 1. æ¸…ç©ºæ—§æ•°æ®
./backend/scripts/clean_stock_data.sh

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
# ç»ˆç«¯ 1
cd backend && python -m uvicorn app.main:app --host 127.0.0.1 --port 8000 --reload

# ç»ˆç«¯ 2
cd frontend && npm run dev

# 3. å¯¼å…¥æµ‹è¯•æ•°æ®
# æ‰“å¼€: http://127.0.0.1:5173/admin/import
# æŒ‰ç…§ test-data/QUICK_START.md æ“ä½œ

# 4. è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯
# ... æµ‹è¯•ä½ çš„åŠŸèƒ½ ...

# 5. é‡å¤ï¼ˆè¿”å›ç¬¬ 1 æ­¥ï¼‰
```

---

## æ–‡ä»¶ä½ç½®

```
backend/scripts/
â”œâ”€â”€ clean_stock_data.sh        â† è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼ˆæ¨èï¼‰
â”œâ”€â”€ clean_stock_data.sql       â† SQL è„šæœ¬ï¼ˆè‡ªåŠ¨è°ƒç”¨ï¼‰
â”œâ”€â”€ CLEAN_STOCK_DATA_README.md â† è¯¦ç»†æ–‡æ¡£
â””â”€â”€ ...
```

---

## æ‰§è¡Œæ—¶é—´

- **æ¸…ç©º ~579,000 æ¡è®°å½•**: 5-10 ç§’
- **éªŒè¯ç»“æœ**: < 1 ç§’
- **æ€»è®¡**: < 15 ç§’

---

## å¸¸è§é—®é¢˜

**Q: è„šæœ¬è¦æ±‚ç¡®è®¤æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ**
A: è¿™æ˜¯å®‰å…¨æœºåˆ¶ï¼Œé˜²æ­¢è¯¯æ“ä½œã€‚æŒ‰ `y` ç¡®è®¤ï¼ŒæŒ‰ `n` å–æ¶ˆã€‚

**Q: æ‰§è¡Œå‡ºé”™äº†æ€ä¹ˆåŠï¼Ÿ**
A: æ£€æŸ¥é”™è¯¯ä¿¡æ¯ï¼Œå¸¸è§åŸå› ï¼š
- ç”¨æˆ·åé”™è¯¯ â†’ ç”¨ `DB_USER=correct_user` æŒ‡å®š
- æ•°æ®åº“è¿æ¥å¤±è´¥ â†’ ç¡®ä¿ PostgreSQL åœ¨è¿è¡Œ
- å¤–é”®çº¦æŸ â†’ è¯´æ˜æœ‰æ–°è¡¨éœ€è¦åœ¨è„šæœ¬ä¸­å¤„ç†

**Q: èƒ½æ¢å¤è¢«åˆ é™¤çš„æ•°æ®å—ï¼Ÿ**
A: æ— æ³•æ¢å¤ã€‚åº”è¯¥å®šæœŸå¤‡ä»½ï¼š
```bash
pg_dump -U peak stock_analysis > backup_$(date +%Y%m%d).sql
```

---

## ç›¸å…³æ–‡æ¡£

- ğŸ“– **å®Œæ•´æ–‡æ¡£**: `backend/scripts/CLEAN_STOCK_DATA_README.md`
- ğŸš€ **å¯¼å…¥æŒ‡å—**: `test-data/QUICK_START.md`
- ğŸ“Š **æµ‹è¯•æ•°æ®**: `test-data/README.md`
- ğŸ”„ **å¯¼å…¥æµç¨‹**: `.spec-workflow/data-import-workflow.md`

---

**åˆ›å»ºæ—¶é—´**: 2025-11-28
**è„šæœ¬ç‰ˆæœ¬**: 1.0
**æäº¤**: 0f71bd4
